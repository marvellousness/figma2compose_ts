<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <style>
      body {
        font-family: sans-serif;
        font-size: 14px;
        padding: 1em;
        line-height: 1.4;
      }

      .node {
        margin-left: 1em;
        border-left: 1px dashed #ccc;
        padding-left: 0.5em;
      }

      .node-title {
        font-weight: bold;
        color: #4a4a4a;
      }

      .attribute {
        color: #444;
        margin-left: 1em;
      }

      .preview {
        margin: 1em 0;
        border: 1px solid #ccc;
        width: 100%;
        max-width: 200px;
        height: auto;
      }
    </style>
  </head>
  <body>
    <div id="tree">Select a node in Figma...</div>

    <script>
      function renderNode(node) {
        let html = `
          <div class="node">
            <div class="node-title">${node.type} - ${node.name}</div>
            <img class="preview" src="${node.preview}" alt="Preview of ${node.name}" />
            <div class="attribute">ID: ${node.id}</div>
            <div class="attribute">Visible: ${node.visible}</div>
            <div class="attribute">Size: ${node.width} Ã— ${node.height}</div>
            <div class="attribute">Position: (${node.x}, ${node.y})</div>
            <div class="attribute">Rotation: ${node.rotation}</div>
            <div class="attribute">Opacity: ${node.opacity}</div>
        `;

        if (node.children && node.children.length > 0) {
          html += `<div class="attribute">Children:</div>`;
          node.children.forEach((child) => {
            html += renderNode(child);
          });
        }

        html += `</div>`;
        return html;
      }

      window.onmessage = (event) => {
        const msg = event.data.pluginMessage;
        const tree = document.getElementById("tree");

        if (msg.type === "NO_SELECTION") {
          tree.innerHTML = "<p>Please select a node.</p>";
        }

        if (msg.type === "NODE_TREE") {
          const html = renderNode(msg.data);
          tree.innerHTML = html;
        }
      };
    </script>
  </body>
</html>
